<!--<p *ngFor="let trans of transactions">{{trans.amount}}</p>-->
<div>
  <span *ngIf="this.investorPercentage==1">
    You have full ownership on this apartment
  </span>
  <ng-container *ngIf="this.investorPercentage && this.investorPercentage!=1">

    <mat-icon [matTooltip]="showPercentage?'Click to show full value':'Click to show your part'"
              style="cursor:pointer;"
              [ngClass]="{'disabled':!showPercentage, 'percentage-icon':showPercentage}"
              (click)="showHidePercentage()">pie_chart</mat-icon>
    <span class="align-icon" *ngIf="showPercentage">Showing only your part ({{percentage*100}}%)</span>
    <span class="align-icon" *ngIf="!showPercentage">Showing full value (100%)</span>
  </ng-container>
  <mat-tab-group #tabGroup dynamicHeight="false">
    <mat-tab>
      <ng-template mat-tab-label>
          <span>Summary</span>
          <mat-icon *ngIf="purchaseReport && math.abs(purchaseReport.investment+purchaseReport.totalCost)>1"
           style="color: red" 
           matTooltip="Investment not equal expenses">warning</mat-icon>
      </ng-template>
      <mat-card *ngIf="apartmentInfo">
        <mat-card-title>Investment Summary - {{apartmentInfo.address}}</mat-card-title>
        <mat-list *ngIf="summaryReport">
          <mat-list-item>
            <mat-icon mat-list-icon>business_center</mat-icon>
            <span class="lineTitle">Investment</span>
            <span [ngClass]="'positive'">{{summaryReport.investment *percentage | currency:'EUR' : number:'1.0-0'}}</span>
          </mat-list-item>

          

          <mat-list-item>
            <mat-icon mat-list-icon>business_center</mat-icon>
            <span style="cursor: pointer;"  (click)="tabGroup.selectedIndex=1" 
            matTooltip="For details see 'Income Report' tab"
            class="lineTitle">Net income for investor</span>
            <span
            (click)="tabGroup.selectedIndex=1" 
            [ngClass]="{
              positive: isPositive(summaryReport.netForInvestor*percentage),
              negative: !isPositive(summaryReport.netForInvestor*percentage)
            }">
            {{summaryReport.netForInvestor| currency:'EUR' : number:'1.0-0' | minusSignToParens}} 
          </span>
          </mat-list-item>


<!-- 
          <mat-list-item>
            <mat-icon mat-list-icon>business_center</mat-icon>
            <span  (click)="tabGroup.selectedIndex=1" 
            matTooltip="For details see 'Income Report' tab" 
            class="lineTitle">Net Income up-to-date</span>
            <span [ngClass]="'positive'">{{summaryReport.netIncome*percentage| currency:'EUR' : number:'1.0-0'}}</span>
         
          </mat-list-item> -->

          <mat-list-item style="cursor:pointer; color:#2222c7" (click)="showTrans(100, 'Distributed', false)">
            <mat-icon mat-list-icon>business_center</mat-icon>
            <span matTooltip="Distributed = Distributed to personal account (available for withdrawal at any moment)"
            class="lineTitle">Distributed</span>
            <span>{{summaryReport.distributed*percentage | currency:'EUR' : number:'1.0-0'}}</span>
          </mat-list-item>
          <mat-divider></mat-divider>

          <mat-list-item >
            <mat-icon mat-list-icon>business_center</mat-icon>
            <span *ngIf="this.investorPercentage<1"
            matTooltip="Profits that are available for distribution but still hasn't beed distributed (will be distributed at the end of the year)"
            class="lineTitle">Current Balance</span>
            <span *ngIf="this.investorPercentage==1"
            matTooltip="You have a full ownership on this apartment hence 'Balance' equal to 'Net Income for Investor'"
            class="lineTitle">Current Balance</span>
            <span 
                  attr.data-amount="{{summaryReport.balance*percentage }}"
                  style="font-weight:bold"
                  [ngClass]="{
                    positive: isPositive(summaryReport.balance*percentage),
                    negative: !isPositive(summaryReport.balance*percentage)
                  }">
                  {{summaryReport.balance*percentage| currency:'EUR' : number:'1.0-0'}}
                </span>
          </mat-list-item>
          <!--*ngIf="apartmentId!=20"-->
          <div>
            <mat-divider></mat-divider>
            <mat-list-item >
              <mat-icon mat-list-icon>business_center</mat-icon>
              <span 
              matTooltip="Conservative: Take into consideration all expenses and taxes and assume 11 month a year" 
              class="lineTitle">Predicted Net ROI (rent)</span>
              <span>{{summaryReport.predictedROI|percent:'1.1'}} </span>
            </mat-list-item>

            <mat-list-item>
              <mat-icon mat-list-icon>business_center</mat-icon>
              <span class="lineTitle">Annual ROI (rent)</span>
              <span>{{summaryReport.roi|percent:'1.1-2'}} </span>
            </mat-list-item>

            <mat-list-item>
              <mat-icon mat-list-icon>business_center</mat-icon>
              <span class="lineTitle">Annual ROI for investor (after bonus)</span>
              <!-- <span>{{getRoiForInvestor(summaryReport.roi)|percent:'1.1'}} </span> -->
              <span>{{summaryReport.roiForInvestor|percent:'1.1-2'}} </span>


              
            </mat-list-item>
            <!-- <mat-list-item>
              <mat-icon mat-list-icon>business_center</mat-icon>
              <span class="lineTitle">Bonus</span>
              <span
              [ngClass]="{
                positive: isPositive(summaryReport.bonus*percentage),
                negative: !isPositive(summaryReport.bonus*percentage)
              }">
                {{summaryReport.bonus| currency:'EUR' : number:'1.0-0' | minusSignToParens}} </span>
            </mat-list-item> -->

          </div>
        </mat-list>
      </mat-card>
    </mat-tab>
    <mat-tab label="Income Report">
      <mat-card>
        <mat-card-title>Income Report</mat-card-title>
     
        <mat-card-subtitle>
          <form #yearForm="ngForm">
            <mat-form-field style="width: 100%" appearance="outline">
              <mat-label>Year</mat-label>
              <mat-select (selectionChange)="onChange($event)" [(ngModel)]="selectedYear" placeholder="Placeholder" name="selectedYear">
                <mat-option [value]="0">All</mat-option>
                <mat-option *ngFor="let year of years" [value]="year">
                  {{year}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </form>
        </mat-card-subtitle>

          <mat-accordion id="report" *ngIf="incomeReport">
            <mat-expansion-panel disabled="true" style="cursor:pointer" (click)="showTrans(1, 'Rent', false)">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <mat-icon mat-list-icon>business_center</mat-icon>
                  <span>Gross Income</span>
                </mat-panel-title>
                <mat-panel-description>
                  <span 
                  [ngClass]="'positive'">{{incomeReport.grossIncome*percentage  | currency:'EUR' : number:'1.0-0'| minusSignToParens}}</span>
                </mat-panel-description>
              </mat-expansion-panel-header>
            </mat-expansion-panel>

            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <mat-icon mat-list-icon>business_center</mat-icon>
                  <span>Expenses</span>
                </mat-panel-title>
                <mat-panel-description>
                  <mat-list-item>
                    <span [ngClass]="'negative'">{{incomeReport.expenses*percentage | currency:'EUR' : number:'1.0-0' | minusSignToParens}}</span>
                  </mat-list-item>
                </mat-panel-description>
              </mat-expansion-panel-header>
            <mat-card-content>
              <mat-list>
                <mat-list-item 
                class="accounts" 
                (click)="showTrans(account.accountId, account.name, false)" 
                style="color:#3764ad" 
                *ngFor="let account of incomeReport?.accountsSum" 
                id="{{account.accountId}}">
                  <mat-icon mat-list-icon>business_center</mat-icon><!--#8a5050-->
                  <span>{{account.name}}</span>
                  <span>{{account.total*percentage*percentage   | currency:'EUR' : number:'1.0-1'}}</span>
                </mat-list-item>

              </mat-list>
            </mat-card-content>
            </mat-expansion-panel>
            <mat-divider></mat-divider>
            <mat-expansion-panel disabled="true">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <mat-icon mat-list-icon>business_center</mat-icon>
                  <span>Net Income</span>
                </mat-panel-title>
                <mat-panel-description>
                  <span style="font-weight:bold" [ngClass]="{
          positive: isPositive(incomeReport.netIncome),
          negative: !isPositive(incomeReport.netIncome)
        }">{{incomeReport.netIncome*percentage  | currency:'EUR' : number:'1.0-0' | minusSignToParens}}</span>
                </mat-panel-description>
              </mat-expansion-panel-header>
            </mat-expansion-panel>
            <mat-expansion-panel disabled="true">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <mat-icon mat-list-icon>business_center</mat-icon>
                  <span matTootip="Bonus to entrepreneur">Bonus</span>
                </mat-panel-title>
                <mat-panel-description>
                  <span [ngClass]="{
          positive: isPositive(incomeReport.bonus),
          negative: !isPositive(incomeReport.bonus)
        }">{{incomeReport.bonus*percentage  | currency:'EUR' : number:'1.0-0' | minusSignToParens}}</span>
                </mat-panel-description>
              </mat-expansion-panel-header>
            </mat-expansion-panel>
            <mat-divider></mat-divider>
            <mat-expansion-panel disabled="true">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <mat-icon mat-list-icon>business_center</mat-icon>
                  <span matTootip="NetForInvestor">Net for Investor</span>
                </mat-panel-title>
                <mat-panel-description>
                  <span style="font-weight:bold" [ngClass]="{
          positive: isPositive(incomeReport.netForInvestor),
          negative: !isPositive(incomeReport.netForInvestor)
        }">{{incomeReport.netForInvestor*percentage  | currency:'EUR' : number:'1.0-0' | minusSignToParens}}</span>
                </mat-panel-description>
              </mat-expansion-panel-header>
            </mat-expansion-panel>
          </mat-accordion>

      
      </mat-card>

    </mat-tab>
    <mat-tab label="Purchase Report">
      <mat-card>
        <mat-card-title>Purchase Report</mat-card-title>

        <mat-card-content>

          <mat-accordion id="report" *ngIf="purchaseReport">
            <mat-expansion-panel disabled="true">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <mat-icon mat-list-icon>business_center</mat-icon>
                  <span>Investment</span>
                </mat-panel-title>
                <mat-panel-description>
                  <span [ngClass]="{
          positive: isPositive(purchaseReport.investment),
          negative: !isPositive(purchaseReport.investment)
        }">{{purchaseReport.investment*percentage | currency:'EUR' : number:'1.0-0'| minusSignToParens}}</span>
                </mat-panel-description>
              </mat-expansion-panel-header>
            </mat-expansion-panel>

            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <mat-icon mat-list-icon>business_center</mat-icon>
                  <span>Total Cost</span>
                </mat-panel-title>
                <mat-panel-description>
                  <mat-list-item>
                    <span [ngClass]="{
          positive: isPositive(purchaseReport.totalCost),
          negative: !isPositive(purchaseReport.totalCost)
        }">{{purchaseReport.totalCost*percentage | currency:'EUR' : number:'1.0-0' | minusSignToParens}}</span>
                  </mat-list-item>
                </mat-panel-description>
              </mat-expansion-panel-header>
              <mat-list>
                <mat-list-item (click)="showTrans(account.accountId, account.name, true)" style="color:#3764ad" *ngFor="let account of purchaseReport?.accountsSum" id="{{account.accountId}}">
                  <mat-icon mat-list-icon>business_center</mat-icon>
                  <span>{{account.name}}</span>
                  <span>{{account.total*percentage  | currency:'EUR' : number:'1.0-1'}}</span>
                </mat-list-item>
                <mat-divider></mat-divider>
              </mat-list>
            </mat-expansion-panel>



            <mat-expansion-panel id="renovation" disabled="true">
              <mat-expansion-panel-header>
                <mat-panel-title matTooltip="Included in 'Total Cost'">
                  <mat-icon mat-list-icon>business_center</mat-icon>
                  <span>Renovation Cost</span>
                </mat-panel-title>
                <mat-panel-description>
                  <span>{{purchaseReport.renovationCost*percentage  | currency:'EUR' : number:'1.0-0'| minusSignToParens}}</span>
                </mat-panel-description>
              </mat-expansion-panel-header>
            </mat-expansion-panel>

            <mat-expansion-panel id="expenses-no-renovation" disabled="true">
              <mat-expansion-panel-header>
                <mat-panel-title matTooltip="Included in 'Total Cost'">
                  <mat-icon mat-list-icon>business_center</mat-icon>
                  <span>Expenses without renovation</span>
                </mat-panel-title>
                <mat-panel-description>
                  <span>{{purchaseReport.expensesNoRenovation *percentage | currency:'EUR' : number:'1.0-0' | minusSignToParens}}</span>
                </mat-panel-description>
              </mat-expansion-panel-header>
            </mat-expansion-panel>
            <!--<mat-divider></mat-divider>
    <mat-expansion-panel disabled="true">
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-icon mat-list-icon>business_center</mat-icon>
          <span>Remanider</span>
        </mat-panel-title>
        <mat-panel-description>
          <span style="font-weight:bold" [ngClass]="{
    positive: isPositive(purchaseReport.remainder),
    negative: !isPositive(purchaseReport.remainder)
  }">{{purchaseReport.remainder *percentage | currency:'EUR' : number:'1.0-0' | minusSignToParens}}</span>
        </mat-panel-description>
      </mat-expansion-panel-header>
    </mat-expansion-panel>-->
          </mat-accordion>
        </mat-card-content>
      </mat-card>
    </mat-tab>
    <mat-tab label="General Info">
      <mat-card>

        <mat-card-title>General Info</mat-card-title>
        <mat-list *ngIf="apartmentInfo">
          <mat-list-item>
            <mat-icon mat-list-icon>home</mat-icon>
            <span class="lineTitle">Investment</span>
            <span>{{apartmentInfo.address}}</span>
          </mat-list-item>

          <mat-list-item>
            <mat-icon mat-list-icon>date_range</mat-icon>
            <span class="lineTitle">Date Purchased</span>
            <span>{{apartmentInfo.purchaseDate | date:'yyyy-MM-dd'}}</span>
          </mat-list-item>

          <mat-list-item *ngIf="apartmentId!=20">
            <mat-icon mat-list-icon>home</mat-icon>
            <span class="lineTitle">Floor</span>
            <span>{{apartmentInfo.floor}}</span>
          </mat-list-item>
          <mat-list-item>
            <mat-icon mat-list-icon>home</mat-icon>
            <span class="lineTitle">Size</span>
            <span>{{apartmentInfo.size}}</span>
          </mat-list-item>
          <mat-list-item>
            <mat-icon mat-list-icon>money</mat-icon>
            <span class="lineTitle">Current Rent</span>
            <span>{{apartmentInfo.currentRent| currency:'EUR' : number:'1.0-0'}}</span>
          </mat-list-item>
          <mat-list-item>
            <mat-icon mat-list-icon>business_center</mat-icon>
            <span class="lineTitle">Status</span>
            <span>{{apartmentInfo.status}}</span>
          </mat-list-item>

        </mat-list>
      </mat-card>
    </mat-tab>
    <mat-tab *ngIf="false"  label="Appraisal">
      <mat-card>
        <mat-list *ngIf="apartmentInfo && purchaseReport">
          <mat-list-item>
            <mat-icon mat-list-icon>business_center</mat-icon>
            <span class="lineTitle">Investment</span>
            <span>{{purchaseReport.investment| currency:'EUR' : number:'1.0-0'}}</span>
          </mat-list-item>

          <mat-list-item>
            <mat-icon mat-list-icon>money</mat-icon>
            <span class="lineTitle">Current Rent</span>
            <span>{{apartmentInfo.currentRent| currency:'EUR' : number:'1.0-0'}}</span>
          </mat-list-item>
          <mat-list-item>
            <mat-icon mat-list-icon>money</mat-icon>
            <span class="lineTitle">Annual Raw Income</span>
            <span>{{apartmentInfo.currentRent*rentMonthsInYear | currency:'EUR' : number:'1.0-0'}}</span>
          </mat-list-item>
          <mat-divider></mat-divider>
          <h3 matSubheader>Assumptions</h3>

          <!--<input style="width:20px" [(ngModel)]="rentMonthsInYear" />
          <input style="width:20px" [(ngModel)]="buyerExpectedRerutn" />-->


          <mat-list-item>
            <mat-icon mat-list-icon>settings_applications</mat-icon>
            <span class="lineTitle">Rent months per year</span>
            <input type="number" min="10" max="12" onkeydown="return false" style="width:40px; border:none" [(ngModel)]="rentMonthsInYear" />
          </mat-list-item>


          <mat-list-item>
            <mat-icon mat-list-icon>settings_applications</mat-icon>
            <span class="lineTitle">ROI expected by buyer</span>
            <input type="number" min="0.03" max="0.06" step="0.01" onkeydown="return false" style="width:50px; border:none" [(ngModel)]="buyerExpectedRerutn" />

          </mat-list-item>

          <mat-divider></mat-divider>
          <h3 matSubheader>Prediction</h3>


          <!--<mat-list-item>
            <mat-icon mat-list-icon>business_center</mat-icon>
            <span class="lineTitle">Raw ROI</span>
            <span>{{apartmentInfo.currentRent*rentMonthsInYear/purchaseReport.investment | percent}}</span>
          </mat-list-item>-->
          <mat-list-item>
            wi
            <mat-icon mat-list-icon>
              business_center
              wi
            </mat-icon>
            wi
            <span class="lineTitle">Price for {{buyerExpectedRerutn | percent}}</span>
            <span>{{(apartmentInfo.currentRent*rentMonthsInYear/buyerExpectedRerutn)  | currency:'EUR' : number:'1.0-0'}}</span>
          </mat-list-item>
          <mat-list-item matTooltip="Based on 10% sale cost">
            <mat-icon mat-list-icon>trending_up</mat-icon>
            <span class="lineTitle">Estimated Profit on Sale</span>
            <span>{{((apartmentInfo.currentRent*rentMonthsInYear/buyerExpectedRerutn)*0.9)- purchaseReport.investment  | currency:'EUR' : number:'1.0-0'}}</span>
          </mat-list-item>
          <mat-list-item matTooltip="Based on 10% sale cost">
            <mat-icon mat-list-icon>trending_up</mat-icon>
            <span class="lineTitle">Estimated ROI on Sale [TODO: calc per year]</span>
            <span>{{((((apartmentInfo.currentRent*rentMonthsInYear/buyerExpectedRerutn)*0.9)/ purchaseReport.investment)-1) | percent:'1.1'}}</span>
          </mat-list-item>


          <!--<mat-divider></mat-divider>-->



        </mat-list>
      </mat-card>
    </mat-tab>
  </mat-tab-group>


</div>



